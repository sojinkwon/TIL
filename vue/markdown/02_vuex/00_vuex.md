# 00_Vuex

> 2020.11.13 ì˜¤ì „ ë¼ì´ë¸Œ

[ê°•ì˜ ì½”ë“œ](https://lab.ssafy.com/ssafy4/vue)



## 1. Vuex

### 1.1. ë‹¨ë°©í–¥ ë°ì´í„° íë¦„

Vue.jsì—ì„œ ë°ì´í„° ê´€ë¦¬ì˜ ê¸°ë³¸ ì»¨ì…‰ì€ ë¶€ëª¨ì—ì„œ ìì‹ìœ¼ë¡œ íë¥´ëŠ” 'ë‹¨ë°©í–¥'ì´ë‹¤. 

- ë°ì´í„°ì˜ íë¦„ì„ ëª…í™•í•˜ê²Œ íŒŒì•…í•  ìˆ˜ ìˆê³  ì´ë¥¼ ì œì–´í•˜ê¸° ì‰¬ì›Œì§„ë‹¤. 
- ì´ë•Œ ê° ì»´í¬ë„ŒíŠ¸ì—ì„œ ê³µìœ í•˜ëŠ” ë°ì´í„°ì˜ ìƒíƒœëŠ” ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë³€ê²½ë˜ë”ë¼ë„ ë™ì¼í•œ ìƒíƒœë¥¼ ê°€ì ¸ì•¼í•œë‹¤. 
- ìƒíƒœë¥¼ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ìœ„ & ì•„ë˜ë¡œ ì „ë‹¬í•˜ëŠ” ê³¼ì •ì—ì„œ ë°˜ë³µì ì¸ ì½”ë“œì™€ ë³µì¡í•˜ê³  ë¶ˆí•„ìš”í•œ ë¡œì§ì´  ë°œìƒí•œë‹¤.

![image-20201114003533717](00_vuex.assets/image-20201114003533717.png)



### 1.2. ì¤‘ì•™ (ì§‘ì¤‘) ì €ì¥ì†Œ 

ì»´í¬ë„ŒíŠ¸ê°€ ë§ê³  ì»´í¬ë„ŒíŠ¸ê°„ ê³µìœ í•˜ëŠ” ìƒíƒœ ì •ë³´ê°€ ë§ì•„ì§€ëŠ” ê²½ìš° ì´ë¥¼ ì¤‘ì•™ì—ì„œ ê´€ë¦¬í•˜ë„ë¡ í•œë‹¤.

- ê° ì»´í¬ë„ŒíŠ¸ ë³„ë¡œ ìƒíƒœ ì •ë³´ë¥¼ í•˜ë‚˜í•˜ë‚˜ ë™ê¸°í™” ì‹œí‚¬ í•„ìš”ê°€ ì—†ë‹¤.
- Storeì— ì €ì¥ëœ ìƒíƒœ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë˜ë©´ ì´ë¥¼ ê³µìœ í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” ì•Œì•„ì„œ ì´ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•˜ê³  ë°˜ì˜í•œë‹¤.
- ë” ì´ìƒ ë°ì´í„°ë¥¼ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì—ì„œ ê´€ë¦¬í•´ì•¼ í•˜ëŠ” ë¶ˆí¸í•¨ì´ ì‚¬ë¼ì§„ë‹¤.

![image-20201114003510444](00_vuex.assets/image-20201114003510444.png)



## 2. Vuex Core Concept

> "VuexëŠ” ë¬´ì¡°ê±´ ë„ì…í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ í•„ìš”í•œ ìˆœê°„ì— ì ì ˆí•œ íŒë‹¨ì„ í†µí•´ ê²°ì •í•´ì•¼ í•œë‹¤."



![image-20201114003522956](00_vuex.assets/image-20201114003522956.png)

1. `State`

   https://vuex.vuejs.org/kr/guide/state.html

   - `Mutations`ì— ì •ì˜ëœ ë©”ì„œë“œì— ì˜í•´ ë³€ê²½
   - ì¤‘ì•™ì—ì„œ ê´€ë¦¬í•˜ëŠ” ëª¨ë“  ìƒíƒœ ì •ë³´ ì¦‰, dataë¥¼ ì˜ë¯¸í•œë‹¤.
   - 'ì¤‘ì•™ ì§‘ì¤‘ì‹ ê´€ë¦¬'ë¼ëŠ” ê±´ Vue.jsë¡œ ë§Œë“  ì„œë¹„ìŠ¤ì— ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  ìƒíƒœë¥¼ 'í•œ ê³³'ì— ëª¨ì•„ì„œ ê´€ë¦¬í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.
   - ì´ì „ì˜ ë°©ì‹ì€ stateë¥¼ ì°¾ê¸° ìœ„í•´ ê° ì»´í¬ë„ŒíŠ¸ë¥¼ í•˜ë‚˜ í•˜ë‚˜ ì‚´í´ë´ì•¼ í–ˆë‹¤ë©´, Vuexë¥¼ í™œìš©í•˜ëŠ” ë°©ì‹ì€ Storeì—ì„œ ê´€ë¦¬í•˜ëŠ” ë°ì´í„°ì—ë¥¼ í†µí•´ stateë¥¼ í•œ ëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆë‹¤.
   - (ê·¸ë¦¬ê³  ì—¬ì „íˆ) stateê°€ ë³€í™”í•˜ë©´ í•´ë‹¹ state ì •ë³´ë¥¼ ê³µìœ í•œ ì»´í¬ë„ŒíŠ¸ì˜ DOMì€ Re-renderingëœë‹¤.

2. `Vue Components`

   - Vuex Storeì—ì„œ state ì •ë³´ë¥¼ ê°€ì ¸ì™€ ì‚¬ìš©í•œë‹¤.
   - *Dispatchë¥¼ ì‚¬ìš©í•´ Actionsë¥¼ í˜¸ì¶œí•œë‹¤.*

3. `Actions`

   https://vuex.vuejs.org/kr/guide/actions.html

   - *Vue Componentsì—ì„œ `dispatch`ë©”ì„œë“œì— ì˜í•´ í˜¸ì¶œëœë‹¤.*
   - Backend APIì™€ í†µì‹ í•˜ì—¬ data fetching ë“±ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.
     - ì´ ê³¼ì •ì—ì„œ ë™ê¸°ì ì¸ ì‘ì—… ë¿ë§Œ ì•„ë‹ˆë¼ ë¹„ë™ê¸°ì ì¸ ì‘ì—…ì„ í¬í•¨í•  ìˆ˜ ìˆë‹¤.
     - stateë¥¼ ë³€ê²½í•˜ì§€ ì•ŠëŠ” ê±´ ë¹„ë™ê¸°ì ì¸ ì‘ì—… ê³¼ì •ì—ì„œ stateì˜ ìƒíƒœê°€ ì˜ˆìƒí•˜ëŠ” ê²ƒê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
   - í•­ìƒ `context` ê°€ ì¸ìë¡œ ë„˜ì–´ì˜¨ë‹¤.
     - ì´ë¦„ì´ `context` ì´ìœ ëŠ” í•´ë‹¹ ê°ì²´ëŠ” ëª¨ë“  Vuex ìš”ì†Œì— ì ‘ê·¼í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
     - ì¦‰, (ìš°ë¦¬ê°€ ì‘ì„± í•  ì½”ë“œì—ì„œ) `store.js` íŒŒì¼ ë‚´ì— ìˆëŠ” ëª¨ë“  ìš”ì†Œì— ì ‘ê·¼í•´ì„œ ì†ì„± ì ‘ê·¼ & ë©”ì„œë“œ í˜¸ì¶œì´ ê°€ëŠ¥í•˜ë‹¤.
   - ë‹¨, (ê°€ëŠ¥í•˜ì§€ë§Œ) stateë¥¼ ì§ì ‘ ë³€ê²½í•˜ì§€ ì•ŠëŠ”ë‹¤.
     - mutationsì— ì •ì˜ëœ ë©”ì„œë“œë¥¼ `commit` ë©”ì„œë“œë¡œ í˜¸ì¶œí•œë‹¤.
     - stateëŠ” ì˜¤ë¡œì§€ mutations ë©”ì„œë“œë¥¼ í†µí•´ì„œë§Œ ì¡°ì‘í•œë‹¤.
     - ëª…í™•í•œ ì—­í•  ë¶„ë‹´ì„ í†µí•´ ì„œë¹„ìŠ¤ ê·œëª¨ê°€ ì»¤ì ¸ë„ stateë¥¼ ì˜¬ë°”ë¥´ê²Œ ê´€ë¦¬í•˜ê¸° ìœ„í•¨ì´ë‹¤.

4. `Mutations`

   https://vuex.vuejs.org/kr/guide/mutations.html

   - *Actionsì—ì„œ `commit`ë©”ì„œë“œì— ì˜í•´ í˜¸ì¶œëœë‹¤.*
   - stateë¥¼ ë³€ê²½í•œë‹¤. ë•Œë¬¸ì— mutationsì— ì •ì˜í•˜ëŠ” ë©”ì„œë“œì˜ ì²« ë²ˆì§¸ ì¸ìë¡œ stateê°€ ë„˜ì–´ì˜¨ë‹¤.
   - (ê°€ì¥ í•µì‹¬ì´ ë˜ëŠ”) stateë¥¼ ë³€ê²½í•˜ëŠ” ë¡œì§ì´ ë‹´ê¸°ê¸° ë•Œë¬¸ì— 'ë™ê¸°ì 'ì¸ ì½”ë“œë§Œ ì‘ì„±í•œë‹¤.
     - ì§ê´€ì ìœ¼ë¡œ stateê°€ ì–´ë–»ê²Œ ë³€ê²½ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.
     - ì´ë•Œ ë¹„ë™ê¸°ì  ë¡œì§ì´ ìˆ˜í–‰ë˜ë©´ Stateê°€ ë³€í™”í•˜ëŠ” ì‹œì ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê´€ë¦¬ê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.

5. `Getters`

   https://vuex.vuejs.org/kr/guide/getters.html

   - stateë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³  í™œìš©í•˜ì—¬ ê³„ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ì´ ë“¤ì–´ê°„ë‹¤. ì²« ë²ˆì§¸ ì¸ìë¡œ stateê°€ ë„˜ì–´ì˜¨ë‹¤.
   - Vueì˜ computedì™€ ê±°ì˜ ë™ì¼í•˜ë‹¤.
     - ì‹¤ì œ ê³„ì‚°ëœ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼ gettersëŠ” ì €ì¥ì†Œì˜ ìƒíƒœ(state)ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ê³„ì‚°í•œë‹¤.
       - ì˜ˆë¥¼ ë“¤ì–´, stateì— todo listì˜ í•´ì•¼ í•  ì¼ì˜ ëª©ë¡ì´ ìˆë‹¤ê³  ìƒê°í•´ë³´ì. todoê°€ ì™„ë£Œëœ ëª©ë¡ë§Œ filteringí•´ì„œ ë³´ì—¬ì¤˜ì•¼ í•˜ëŠ” ê²½ìš° gettersì—ì„œ `.filter` array helperë¥¼ ì‚¬ìš©í•´ `completed`ì˜ ê°’ì´ `true`ì¸ ìš”ì†Œê°€ í•„í„°ë§ í•´ì„œ ê³„ì‚°ëœ ê°’ì„ ë‹´ì•„ ë†“ëŠ”ë‹¤.
       - í˜¹ì€ ìš°ë¦¬ê°€ í™œìš©í•œ ì˜ˆì‹œì²˜ëŸ¼ ëª¨ë“  todosì˜ ê°œìˆ˜ ë° í•„í„°ë§ì´ ëœ ìš”ì†Œì˜ ê°œìˆ˜ ë“±ì„ íŒŒì•…í•  ìˆ˜ ìˆë‹¤.
   - ì—¬ê¸°ì„œ í•µì‹¬ì€ getters ìì²´ê°€ stateë¥¼ 'ë³€ê²½'í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤.
     - ë‹¨ìˆœí•˜ê²Œ stateë¥¼ íŠ¹ì •í•œ ì¡°ê±´ì— ë”°ë¼ êµ¬ë¶„(ê³„ì‚°)í•œë‹¤.
     - ê³„ì‚°ëœ ê°’ì„ 'ê°€ì ¸ì˜¨ë‹¤(get)' ì •ë„ë¡œ ì´í•´í•´ë³´ì/

6. `modules`

   https://vuex.vuejs.org/kr/guide/modules.html

   - Vuex ë‚´ë¶€ì˜ ìš”ì†Œê°€ ì»¤ì¡Œì„ ë•Œ ì´ë¥¼ ë‹¤ì‹œ ëª¨ë“ˆí™” í•  ë•Œ ì‚¬ìš©í•œë‹¤.



## 3. Todo List with Vuex

ìì„¸í•œ ì½”ë“œëŠ” ìˆ˜ì—… ë•Œ ì‘ì„±í•œ ì™„ì„± ì½”ë“œë¥¼ ì°¸ê³  í•´ì£¼ì„¸ìš”.  ğŸ˜Š



### 3.1. ê¸°ë³¸ ì»¨ì…‰ - `Actions` & `Mutations`

1. Vue Components 
   - ê¸°ë³¸ì ìœ¼ë¡œ `dispatch`ë¥¼ ì‚¬ìš©í•´ Actionsì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
2. Actions -> `context`
   - Vue Componentsì—ì„œ ë°›ì€ í˜¸ì¶œì˜ ê²°ê³¼ë¡œ `commit` ë©”ì„œë“œë¥¼ í™œìš©í•´ Mutationsì˜ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•œë‹¤.
   - Actionsì—ëŠ” ì‹¤ì œë¡œ ìš°ë¦¬ê°€ ì‘ì„±í•œ ë¡œì§ë³´ë‹¤ í›¨ì”¬ ë” ë§ì€ ë‚´ìš©ì´ ë‹´ê¸¸ ìˆ˜ ìˆë‹¤.
     - ì˜ˆë¥¼ ë“¤ë©´, Backend APIì™€ì˜ í†µì‹ ì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ê°€ê³µ & ì €ì¥ í•  ìˆ˜ ìˆë‹¤. 
     - ì´ ê³¼ì •ì—ì„œ íŠ¹ì • ì‹œì ì˜ stateë¥¼ ë³€ê²½ ì‹œí‚¤ê³  ì‹¶ì€ ê²½ìš° Actionsê°€ ì•„ë‹Œ Mutationsë¥¼ í˜¸ì¶œí•œë‹¤.
3. Mutations -> `state`
   - Actionsë¡œë¶€í„° ë°›ì€ í˜¸ì¶œì˜ ê²°ê³¼ë¡œ íŠ¹ì •í•œ stateë¥¼ ë³€ê²½í•˜ëŠ” ë¡œì§ì„ ì‹¤í–‰í•œë‹¤. 
   - stateë¥¼ ë°”ê¾¸ê¸° ìœ„í•œ ìœ ì¼í•œ ë¡œì§ì„ í¬í•¨í•œë‹¤.



### 3.2. getters

- computedì²˜ëŸ¼ ê³„ì‚°ëœ ê°’ì„ í™œìš©í•œë‹¤. 
- ìš°ë¦¬ê°€ ì‘ì„±í•œ todo ë¡œì§ì—ì„œëŠ” ëª¨ë“  todo, ì™„ë£Œëœ todo, ë¯¸ì™„ë£Œëœ todo ìš”ì†Œì˜ ìˆ«ìë¥¼ ê³„ì‚°í•  ë•Œ ì‚¬ìš©í•œë‹¤.

```html
<!-- App.vue -->

<template>
  <div id="app">
    <h2>All Todos: {{ allTodoCount }}</h2>
    <h2>ì™„ë£Œëœ í•  ì¼: {{ completedTodoCount }}</h2>
    <h2>ì™„ë£Œë˜ì§€ ì•Šì€ í•  ì¼: {{ uncompletedTodoCount }}</h2>
    <TodoList />
    <TodoForm />
  </div>
</template>
```

```javascript
// App.vue

...
    computed: {
        allTodoCount: function () {
          return this.$store.getters.allTodoCount
        },
        completedTodoCount: function () {
          return this.$store.getters.completedTodoCount
        },
        uncompletedTodoCount: function() {
          return this.$store.getters.uncompletedTodoCount
        }
	}
```



### 3.3. Vuex Helper 

- State, Getters, Mutations, ê·¸ë¦¬ê³  Actionsë¥¼ ì¡°ê¸ˆ ë” í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” Helper Method
- ë…¼ë¦¬ì ì¸ ë¡œì§ì´ ë³€í™”í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë‹¨ì§€ ì‚¬ìš©ë²•ì´ 'í¸í•´ì§€ëŠ”' ê²ƒì— ì´ˆì ì„ ë§ì¶˜ë‹¤.

- `mapState` ì™¸ì— ì¶”ê°€ì ì¸ Helperë„ ì‚¬ìš©í•´ë³´ì



```javascript
// TodoList.vue

//1. vuex ëª¨ë“ˆì—ì„œ mapStateë¼ëŠ” keyë¡œ í•¨ìˆ˜ë¥¼ êº¼ë‚´ì˜¨ë‹¤. -> Destructuring
import { mapState } from 'vuex'

import Todo from '@/components/Todo'

export default {
  ...
  computed: {
    // todos: function () {
    //   return this.$store.state.todos
    // }
	//2. mapStateì˜ return ê°’ì€ object -> Spread ë¬¸ë²•ì„ í™œìš©
    ...mapState([
	   // ì´ë•Œ todosëŠ” stateì— ì§€ì •í•œ ì´ë¦„ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
      'todos',
    ])
  }
}
```



ë§Œì•½ ë‹¤ë¥¸ ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ objectë¥¼ í™œìš©í•˜ë©´ ëœë‹¤.

```html
<!-- TodoList.vue -->

<template>
  <div>
    <Todo v-for="(todo, idx) in datas" :key="idx" :todo="todo"/>
  </div>
</template>

<script>
...

export default {
  ...
  computed: {
    // todos: function () {
    //   return this.$store.state.todos
    // }
    ...mapState({
      'datas': 'todos'
    })
  }
}
```



### 3.4. Todo with LocalStorage

https://www.npmjs.com/package/vuex-persistedstate

- vuexì—ì„œ í™œìš©í•˜ëŠ” todo ë°ì´í„°ë¥¼ LocalStorageì— ì•Œì•„ì„œ ì €ì¥ í•´ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ 

1. ì„¤ì¹˜

   ```bash
   $ npm i vuex-persistedstate
   ```

2. plugin ë“±ë¡

   ```javascript
   // store/index.js
   
   import createPersistedState from 'vuex-persistedstate'
   
   
   export default new Vuex.Store({
   	...
   	plugins: [
       createPersistedState(),
     ]
   })
   ```

3. ì‹¤í–‰
   - ìƒˆë¡œê³ ì¹¨í•´ë„ todoê°€ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ”ë‹¤.
   - Chrome DevToolsì˜ Application Tabì˜ `LocalStorage`ë¥¼ í™•ì¸í•´ë³´ë©´ ìš°ë¦¬ê°€ ì‘ì„±í•œ todo ëª©ë¡ì´ ì €ì¥ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.





